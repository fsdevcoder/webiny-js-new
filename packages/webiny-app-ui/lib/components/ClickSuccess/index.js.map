{"version":3,"sources":["../../../src/components/ClickSuccess/index.js"],"names":["ClickSuccess","props","state","data","dialogId","getContent","bind","onClick","hide","services","get","Promise","resolve","realOnClick","then","show","content","children","success","setState","input","Children","toArray","cloneElement","render","call","dialogProps","name","message","onClose","renderDialog","close","Modal","Component","defaultProps","modules"],"mappings":"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","file":"index.js","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport { app, createComponent } from \"webiny-app\";\n\nclass ClickSuccess extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = { data: {} };\n        this.dialogId = _.uniqueId(\"click-success-\");\n\n        this.getContent = this.getContent.bind(this);\n        this.onClick = this.onClick.bind(this);\n        this.hide = this.hide.bind(this);\n    }\n\n    hide() {\n        return app.services.get(\"modal\").hide(this.dialogId);\n    }\n\n    onClick() {\n        return Promise.resolve(this.realOnClick(this)).then(() => {\n            return app.services.get(\"modal\").show(this.dialogId);\n        });\n    }\n\n    getContent() {\n        const content = this.props.children;\n        if (_.isFunction(content)) {\n            return content({\n                success: ({ data }) => {\n                    this.setState({ data }, () => {\n                        app.services.get(\"modal\").show(this.dialogId);\n                    });\n                }\n            });\n        }\n\n        const input = React.Children.toArray(content)[0];\n        this.realOnClick = input.props.onClick;\n        const props = _.omit(input.props, [\"onClick\"]);\n        props.onClick = this.onClick;\n        return React.cloneElement(input, props);\n    }\n\n    render() {\n        if (this.props.render) {\n            return this.props.render.call(this);\n        }\n\n        const dialogProps = {\n            name: this.dialogId,\n            message: () =>\n                _.isFunction(this.props.message)\n                    ? this.props.message(this.state.data)\n                    : this.props.message,\n            onClose: () => {\n                this.hide().then(this.props.onClose);\n            }\n        };\n\n        if (_.isFunction(this.props.renderDialog)) {\n            // TODO: finish this part\n            dialogProps[\"render\"] = this.props.renderDialog.bind(this, {\n                data: this.state.data,\n                close: dialogProps.onClose\n            });\n        }\n\n        const { Modal } = this.props;\n\n        return (\n            <webiny-click-success>\n                {this.getContent()}\n                <Modal.Success {...dialogProps} />\n            </webiny-click-success>\n        );\n    }\n}\n\nClickSuccess.defaultProps = {\n    onClose: _.noop,\n    message: null,\n    renderDialog: null\n};\n\nexport default createComponent(ClickSuccess, { modules: [\"Modal\"] });\n"]}