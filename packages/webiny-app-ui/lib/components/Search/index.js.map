{"version":3,"sources":["../../../src/components/Search/index.js"],"names":["t","namespace","Search","props","state","initialState","query","preview","options","loading","selectedOption","selectedData","mounted","preventBlur","delay","currentValueIsId","filters","unwatch","map","m","bind","filterBy","name","filter","filterName","filterField","form","watch","applyFilter","newValue","value","normalizeValue","attachToForm","newState","id","match","renderPreview","api","get","defaults","url","then","data","response","entity","setState","config","v","clearTimeout","setTimeout","length","minQueryLength","request","params","_searchQuery","onLoadOptions","allowFreeInput","e","onChange","target","loadOptions","key","metaKey","ctrlKey","inputChanged","reset","selectNext","selectPrev","stopPropagation","preventDefault","selectCurrent","applyFreeInput","onEnter","event","onBlur","validate","item","useDataAsValue","valueAttr","selected","current","selectItem","onReset","textAttr","renderSelected","call","option","render","FormGroup","isValid","className","renderLabel","renderInfo","renderSearchInput","$this","renderDescription","renderValidationMessage","Component","defaultProps","searchOperator","inputIcon","loadingIcon","placeholder","renderOptionLabel","fetchValue","content","__html","replace","renderOption","index","styles","itemClasses","linkProps","onMouseDown","onMouseOver","inputProps","type","readOnly","autoComplete","spellCheck","dir","onKeyDown","onKeyUp","disabled","isDisabled","dropdownMenu","autosuggest","plainSearch","Link","Icon","search","btn","icon","modules","formComponent"],"mappings":"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","file":"index.js","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport warning from \"warning\";\nimport classSet from \"classnames\";\nimport { i18n, createComponent, ApiComponent } from \"webiny-app\";\nimport { FormComponent } from \"webiny-app-ui\";\nimport styles from \"./styles.css\";\n\nconst t = i18n.namespace(\"Webiny.Ui.Search\");\nclass Search extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            ...props.initialState,\n            query: \"\", // Value being searched\n            preview: \"\", // Rendered value of selected value\n            options: [],\n            loading: false,\n            selectedOption: -1, // Selected option index\n            selectedData: null // Delected item data\n        };\n\n        this.mounted = false;\n        this.preventBlur = false;\n        this.delay = null;\n        this.currentValueIsId = false;\n        this.filters = {};\n        this.unwatch = _.noop;\n\n        [\n            \"loadOptions\",\n            \"inputChanged\",\n            \"selectItem\",\n            \"selectCurrent\",\n            \"onKeyUp\",\n            \"onBlur\",\n            \"renderPreview\",\n            \"fetchValue\",\n            \"getCurrentData\",\n            \"applyFreeInput\"\n        ].map(m => (this[m] = this[m].bind(this)));\n\n        if (this.props.filterBy) {\n            // Assume the most basic form of filtering (single string)\n            let name = this.props.filterBy;\n            let filter = this.props.filterBy;\n\n            // Check if filterBy is defined as array (0 => name of the input to watch, 1 => filter by field)\n            if (_.isArray(this.props.filterBy)) {\n                name = this.props.filterBy[0];\n                filter = this.props.filterBy[1];\n            }\n\n            // Check if filterBy is defined as object\n            if (_.isPlainObject(this.props.filterBy)) {\n                name = this.props.filterBy.name;\n                filter = this.props.filterBy.filter;\n            }\n\n            this.filterName = name;\n            this.filterField = filter;\n\n            this.unwatch = this.props.form.watch(name, newValue =>\n                this.applyFilter(newValue, name, filter)\n            );\n        }\n    }\n\n    componentWillReceiveProps(props) {\n        if (_.isEqual(props.value, this.props.value)) {\n            return;\n        }\n\n        this.normalizeValue(props);\n    }\n\n    componentWillMount() {\n        this.normalizeValue(this.props);\n    }\n\n    componentDidMount() {\n        this.mounted = true;\n        this.props.attachToForm && this.props.attachToForm(this);\n    }\n\n    componentWillUnmount() {\n        this.mounted = false;\n        this.unwatch();\n    }\n\n    /** Custom methods */\n\n    /**\n     * We support 3 types of values:\n     * - id\n     * - object\n     * - random string\n     *\n     * @param props\n     */\n    normalizeValue(props) {\n        const value = props.value;\n\n        const newState = {\n            options: [],\n            selectedOption: -1,\n            query: \"\"\n        };\n\n        // Try to extract ID\n        let id = null;\n        if (value && _.isString(value) && value.match(/^[0-9a-fA-F]{24}$/)) {\n            id = value;\n        } else if (value && _.isPlainObject(value)) {\n            id = value.id;\n            newState[\"selectedData\"] = value;\n        }\n\n        if (!id && value) {\n            newState[\"preview\"] = value;\n        } else if (id && _.isPlainObject(value)) {\n            newState[\"preview\"] = this.renderPreview(value);\n        } else if (id) {\n            this.props.api.get(this.props.api.defaults.url + \"/\" + value).then(response => {\n                const data = response.data.data.entity;\n                this.setState({ selectedData: data, preview: this.renderPreview(data) });\n            });\n        }\n\n        this.currentValueIsId = !!id;\n        this.setState(newState);\n    }\n\n    getCurrentData() {\n        return this.state.selectedData;\n    }\n\n    applyFilter(newValue, name, filter) {\n        // If filter is a function, it needs to return a config for api created using new value\n        if (_.isFunction(filter)) {\n            const config = filter(newValue, this.api);\n            if (_.isPlainObject(config)) {\n                this.filters = config;\n            }\n        } else {\n            // If filter is a string, create a filter object using that string as field name\n            const filters = {};\n            filters[filter] = _.isObject(newValue) ? newValue.id : newValue;\n            this.filters = filters;\n        }\n        this.filters = _.pickBy(this.filters, v => !_.isNull(v) && !_.isUndefined(v) && v !== \"\");\n    }\n\n    loadOptions(query) {\n        this.setState({ query });\n        clearTimeout(this.delay);\n\n        this.delay = setTimeout(() => {\n            if (\n                _.isEmpty(this.state.query) ||\n                this.state.query.length < this.props.minQueryLength\n            ) {\n                return;\n            }\n\n            if (this.mounted) {\n                this.setState({ loading: true });\n                this.props.api\n                    .request({ params: { _searchQuery: this.state.query, ...this.filters } })\n                    .then(response => {\n                        const { data } = response.data;\n                        this.setState(\n                            { options: _.get(data, \"list\", data), loading: false },\n                            () => {\n                                this.props.onLoadOptions({ options: this.state.options });\n                            }\n                        );\n                    });\n            }\n        }, this.props.allowFreeInput ? 300 : 500);\n    }\n\n    inputChanged(e) {\n        if (this.props.value && this.currentValueIsId && this.props.allowFreeInput) {\n            this.props.onChange(e.target.value);\n        }\n        this.setState({\n            query: e.target.value,\n            preview: \"\",\n            selectedData: null\n        });\n        if (e.target.value.length >= 2) {\n            this.loadOptions(e.target.value);\n        }\n    }\n\n    onKeyUp(e) {\n        this.key = e.key;\n\n        if (e.metaKey || e.ctrlKey) {\n            return;\n        }\n\n        switch (this.key) {\n            case \"Backspace\":\n                if (_.isEmpty(this.state.query) || _.get(this.props, \"value\")) {\n                    // Reset only if it is a selected value with valid mongo ID or data object\n                    const id = _.get(this.props, \"value\");\n                    if (\n                        this.props.allowFreeInput &&\n                        _.isString(id) &&\n                        !id.match(/^[0-9a-fA-F]{24}$/)\n                    ) {\n                        this.inputChanged(e);\n                        break;\n                    }\n                    this.reset();\n                    break;\n                } else {\n                    this.inputChanged(e);\n                }\n                break;\n            case \"ArrowDown\":\n                this.selectNext();\n                break;\n            case \"ArrowUp\":\n                this.selectPrev();\n                break;\n            case \"Enter\":\n                e.stopPropagation();\n                e.preventDefault();\n                if (this.state.options.length > 0) {\n                    this.selectCurrent();\n                } else if (this.props.allowFreeInput) {\n                    this.applyFreeInput();\n                } else {\n                    this.props.onEnter({ event: e });\n                }\n                break;\n            case \"Escape\":\n                this.onBlur();\n                break;\n            case \"Tab\":\n            case \"ArrowLeft\":\n            case \"ArrowRight\":\n                break;\n            default:\n                this.inputChanged(e);\n                break;\n        }\n    }\n\n    onBlur() {\n        if (this.preventBlur) {\n            return;\n        }\n\n        if (!this.props.allowFreeInput) {\n            const state = { options: [] };\n            if (!_.get(this.props, \"value\")) {\n                state[\"query\"] = \"\";\n                state[\"selectedOption\"] = -1;\n            }\n            this.setState(state, this.props.validate);\n        }\n\n        if (this.props.allowFreeInput) {\n            this.applyFreeInput();\n        }\n    }\n\n    applyFreeInput() {\n        if (!this.state.selectedData && !(this.state.query === \"\" && this.state.preview !== \"\")) {\n            this.props.onChange(this.state.query);\n            setTimeout(this.props.validate, 10);\n        }\n    }\n\n    selectItem(item) {\n        this.preventBlur = true;\n        this.setState(\n            {\n                selectedOption: -1,\n                query: \"\",\n                options: [],\n                preview: this.renderPreview(item),\n                selectedData: item\n            },\n            () => {\n                this.props.onChange(this.props.useDataAsValue ? item : item[this.props.valueAttr]);\n                setTimeout(this.props.validate, 10);\n                this.preventBlur = false;\n            }\n        );\n    }\n\n    selectNext() {\n        if (!this.state.options.length) {\n            return;\n        }\n\n        let selected = this.state.selectedOption + 1;\n        if (selected >= this.state.options.length) {\n            selected = this.state.options.length - 1;\n        }\n\n        this.setState({\n            selectedOption: selected,\n            preview: this.renderPreview(this.state.options[selected])\n        });\n    }\n\n    selectPrev() {\n        if (!this.state.options.length) {\n            return;\n        }\n\n        let selected = this.state.options.length - 1;\n        if (this.state.selectedOption <= selected) {\n            selected = this.state.selectedOption - 1;\n        }\n\n        if (selected < 0) {\n            selected = 0;\n        }\n\n        this.setState({\n            selectedOption: selected,\n            preview: this.renderPreview(this.state.options[selected])\n        });\n    }\n\n    selectCurrent() {\n        if (!this.state.options.length) {\n            return;\n        }\n\n        if (this.state.selectedOption === -1) {\n            return;\n        }\n\n        const current = this.state.options[this.state.selectedOption];\n        this.selectItem(current);\n    }\n\n    reset() {\n        this.setState(\n            {\n                selectedOption: -1,\n                query: \"\",\n                preview: \"\",\n                options: [],\n                selectedData: null\n            },\n            () => {\n                this.props.onChange(null);\n                this.props.onReset();\n            }\n        );\n    }\n\n    fetchValue({ data: item }) {\n        let value = _.get(item, this.props.textAttr, item.id);\n\n        warning(\n            value,\n            `Warning: Item attribute '${this.props.textAttr}' was not found in the results of '${\n                this.props.name\n            }' component.\\nMissing or misspelled 'fields' parameter?`\n        );\n\n        return value;\n    }\n\n    renderPreview(item) {\n        if (!item) {\n            return null;\n        }\n        return this.props.renderSelected.call(this, { option: { data: item } });\n    }\n\n    render() {\n        if (this.props.render) {\n            return this.props.render.call(this);\n        }\n\n        const { FormGroup } = this.props;\n\n        return (\n            <FormGroup valid={this.state.isValid} className={this.props.className}>\n                {this.props.renderLabel.call(this)}\n                {this.props.renderInfo.call(this)}\n\n                <div className=\"inputGroup\">\n                    {this.props.renderSearchInput.call(this, { $this: this })}\n                </div>\n                {this.props.renderDescription.call(this)}\n                {this.props.renderValidationMessage.call(this)}\n            </FormGroup>\n        );\n    }\n}\n\nSearch.defaultProps = {\n    searchOperator: \"or\",\n    valueAttr: \"id\",\n    textAttr: \"name\",\n    minQueryLength: 2,\n    onEnter: _.noop,\n    onChange: _.noop,\n    onReset: _.noop,\n    onLoadOptions: _.noop,\n    inputIcon: \"icon-search\",\n    loadingIcon: \"icon-search\",\n    placeholder: t`Type to search`,\n    useDataAsValue: false,\n    allowFreeInput: false,\n    renderOptionLabel({ option }) {\n        const value = this.fetchValue(option);\n        const content = { __html: value.replace(/\\s+/g, \"&nbsp;\") };\n        return <div dangerouslySetInnerHTML={content} />;\n    },\n    renderSelected({ option }) {\n        return this.fetchValue(option);\n    },\n    renderOption({ item, index }) {\n        const { styles } = this.props;\n        const itemClasses = {\n            [styles.selected]: index === this.state.selectedOption\n        };\n\n        const linkProps = {\n            onMouseDown: () => this.selectItem(item),\n            onMouseOver: () =>\n                this.setState({ selectedOption: index, preview: this.renderPreview(item) })\n        };\n\n        return (\n            <li key={index} className={classSet(itemClasses)} {...linkProps}>\n                <a href=\"javascript:void(0)\">\n                    {this.props.renderOptionLabel.call(this, { option: { data: item } })}\n                </a>\n            </li>\n        );\n    },\n    renderSearchInput() {\n        const inputProps = {\n            type: \"text\",\n            readOnly: this.props.readOnly || false,\n            placeholder: this.props.placeholder,\n            autoComplete: \"off\",\n            spellCheck: \"false\",\n            dir: \"auto\",\n            onKeyDown: this.onKeyUp,\n            onBlur: this.onBlur,\n            value: this.state.query || this.state.preview || \"\",\n            onChange: this.inputChanged,\n            disabled: this.props.isDisabled()\n        };\n\n        // Render option\n        const options = this.state.options.map((item, index) =>\n            this.props.renderOption.call(this, { item, index })\n        );\n\n        let dropdownMenu = null;\n        const { styles } = this.props;\n        if (this.state.options.length > 0) {\n            dropdownMenu = (\n                <div className={styles.autosuggest}>\n                    <div className={styles.plainSearch}>\n                        <ul>{options}</ul>\n                    </div>\n                </div>\n            );\n        }\n\n        // Create search input\n        const { Link, Icon } = this.props;\n        return (\n            <div className={styles.search}>\n                <Link className={styles.btn}>\n                    <Icon\n                        className={styles.icon}\n                        icon={this.props.loading ? this.props.loadingIcon : this.props.inputIcon}\n                    />\n                </Link>\n                <input {...inputProps} />\n                {dropdownMenu}\n            </div>\n        );\n    }\n};\n\nexport default createComponent([Search, ApiComponent, FormComponent], {\n    modules: [\"Link\", \"Icon\", \"FormGroup\"],\n    styles,\n    formComponent: true\n});\n"]}