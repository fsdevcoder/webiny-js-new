{"version":3,"sources":["../../../src/components/ExpandableList/Row.jsx"],"names":["Row","props","state","active","mounted","actionSetActive","rowClass","map","m","bind","setState","deatachCloseListener","nextProps","nextState","attachCloseListener","document","addEventListener","handleClickOutside","removeEventListener","e","dom","has","target","length","is","hideRowDetails","hideActionSet","details","find","removeClass","hide","show","addClass","getCurrentRowClass","field","i","data","key","onClick","showRowDetails","cloneElement","render","call","fields","actionSet","children","child","push","className","showActionSet","renderField","Grid","ref","display","title","Component","defaultProps","modules"],"mappings":"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","file":"Row.js","sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport { createComponent, isElementOfType } from 'webiny-app';\nimport Field from './Field';\nimport ActionSet from './ActionSet';\nimport RowDetailsList from './RowDetailsList';\nimport RowDetailsContent from './RowDetailsContent';\n\nclass Row extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            active: false,\n            mounted: false,\n            actionSetActive: false,\n            rowClass: 'expandable-list__row'\n        };\n\n        [\n            'hideRowDetails',\n            'showRowDetails',\n            'handleClickOutside',\n            'renderField',\n            'attachCloseListener',\n            'deatachCloseListener',\n            'showActionSet',\n            'hideActionSet',\n            'getCurrentRowClass'\n        ].map(m => this[m] = this[m].bind(this));\n    }\n\n    componentWillUnmount() {\n        this.setState({ mounted: false });\n        this.deatachCloseListener();\n    }\n\n    componentWillMount() {\n        this.setState({ mounted: true });\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        if (nextState.active === true || nextState.actionSetActive === true) {\n            this.attachCloseListener();\n        } else {\n            this.deatachCloseListener();\n        }\n\n        return true;\n    }\n\n    attachCloseListener() {\n        document.addEventListener('click', this.handleClickOutside, true);\n    }\n\n    deatachCloseListener() {\n        document.removeEventListener('click', this.handleClickOutside, true);\n    }\n\n    handleClickOutside(e) {\n        if ((this.state.active === false && this.state.actionSetActive === false) || !this.state.mounted) {\n            return true;\n        }\n\n        if ($(this.dom).has(e.target).length === 0 && !$(this.dom).is(e.target)) {\n            // clicked outside\n            if (this.state.active) {\n                this.hideRowDetails();\n            } else {\n                this.hideActionSet();\n            }\n        } else {\n            // clicked inside\n            return false;\n        }\n    }\n\n    hideRowDetails() {\n        if (this.state.active === false || !this.state.mounted) {\n            return true;\n        }\n\n        // hide row details\n        const details = this.dom.find('.expandable-list__row__details:first');\n        this.dom.removeClass('expandable-list__row--active');\n        details.hide();\n\n        // show row content\n        this.dom.find('div.expandable-list__row-wrapper:first').show();\n\n\n        this.setState({ active: false });\n    }\n\n    getCurrentRowClass() {\n        if (this.state.active) {\n            return 'expandable-list__row--active expandable-list__row';\n        }\n\n        return 'expandable-list__row';\n    }\n\n    showRowDetails() {\n        if (this.state.active === true) {\n            return true;\n        }\n\n        // show row details\n        const details = $(this.dom).find('.expandable-list__row__details:first');\n        $(this.dom).addClass('expandable-list__row--active');\n        details.show();\n\n        // hide row content and action set\n        $(this.dom).find('div.expandable-list__row-wrapper:first').hide();\n\n        this.setState({ active: true });\n    }\n\n    showActionSet() {\n        this.setState({\n            actionSetActive: true,\n            rowClass: this.getCurrentRowClass() + ' expandable-list__row--active-action-set'\n        });\n    }\n\n    hideActionSet() {\n        this.setState({\n            actionSetActive: false,\n            rowClass: this.getCurrentRowClass()\n        });\n    }\n\n    renderField(field, i) {\n        const props = _.omit(field.props, ['children']);\n        _.assign(props, {\n            data: this.data,\n            key: i,\n            onClick: () => {\n                this.showRowDetails();\n            }\n        });\n\n        return React.cloneElement(field, props);\n    }\n\n    render() {\n        if (this.props.render) {\n            return this.props.render.call(this);\n        }\n\n        let fields = [];\n        let actionSet = false;\n        let details = '';\n        this.props.children.map(child => {\n            if (isElementOfType(child, Field)) {\n                fields.push(child);\n            } else if (isElementOfType(child, RowDetailsContent) || isElementOfType(child, RowDetailsList)) {\n                details = child;\n            } else if (isElementOfType(child, ActionSet)) {\n                actionSet = child;\n            }\n        });\n\n        // render action set\n        if (actionSet) {\n            const className = 'expandable-list__row__action-set expandable-list__row__fields__field flex-cell flex-width-2';\n            actionSet = <div className={className} onClick={this.showActionSet}>{actionSet}</div>;\n        }\n\n        // render fields\n        fields = fields.map(this.renderField);\n\n        const { Grid } = this.props;\n\n        return (\n            <div className={this.state.rowClass} ref={ref => this.dom = ref}>\n                <div className=\"expandable-list__row-wrapper flex-row\">\n                    {fields}\n                    {actionSet}\n                </div>\n                <Grid.Row className=\"expandable-list__row__details\" style={{ display: 'none' }}>\n                    <div className=\"flex-row\">\n                        <div className=\"expandable-list__title flex-cell flex-width-10\"><h4>{details.props.title}</h4>\n                        </div>\n                        {actionSet}\n                    </div>\n                    {this.state.active && details}\n                </Grid.Row>\n            </div>\n        );\n    }\n}\n\nRow.defaultProps = {\n    onClick: _.noop\n};\n\nexport default createComponent(Row, { modules: ['Grid'] });"]}