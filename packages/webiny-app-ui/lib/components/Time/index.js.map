{"version":3,"sources":["../../../src/components/Time/index.js"],"names":["Time","props","valueChanged","bindMethods","nextProps","nextState","omit","oldProps","newProps","state","prevProps","prevState","isValid","input","setState","validationMessage","element","dom","format","inputFormat","I18n","getTimeFormat","convertPhpToJsDateTimeFormat","datetimepicker","stepping","keepOpen","debug","minDate","Date","widgetPositioning","horizontal","positionHorizontal","vertical","positionVertical","on","onChange","e","target","value","newValue","time","modelFormat","validate","getPlaceholder","Ui","FormComponent","defaultProps","disabled","readOnly","placeholder","renderer","omitProps","Input","Icon","renderPreview","addonRight","onRef","setup","ref","createComponent","modules"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AAEA;;;;AACA;;;;IAEMA,I;;;AACF,kBAAYC,KAAZ,EAAmB;AAAA;;AAAA,8HACTA,KADS;;AAEf,cAAKC,YAAL,GAAoB,KAApB;;AAEA,cAAKC,WAAL,CAAiB,gBAAjB;AAJe;AAKlB;;;;8CAEqBC,S,EAAWC,S,EAAW;AACxC,gBAAID,UAAU,YAAV,CAAJ,EAA6B;AACzB,uBAAO,IAAP;AACH;;AAED,gBAAME,OAAO,CAAC,UAAD,EAAa,KAAb,EAAoB,KAApB,EAA2B,UAA3B,CAAb;AACA,gBAAMC,WAAW,oBAAO,KAAKN,KAAZ,EAAmBK,IAAnB,CAAjB;AACA,gBAAME,WAAW,oBAAOJ,SAAP,EAAkBE,IAAlB,CAAjB;;AAEA,mBAAO,CAAC,uBAAUE,QAAV,EAAoBD,QAApB,CAAD,IAAkC,CAAC,uBAAUF,SAAV,EAAqB,KAAKI,KAA1B,CAA1C;AACH;;;2CAEkBC,S,EAAWC,S,EAAW;AACrC;AACA,gBAAIA,UAAUC,OAAV,KAAsB,KAAKH,KAAL,CAAWG,OAArC,EAA8C;AAC1C,qBAAKC,KAAL,CAAWC,QAAX,CAAoB;AAChBF,6BAAS,KAAKH,KAAL,CAAWG,OADJ;AAEhBG,uCAAmB,KAAKN,KAAL,CAAWM;AAFd,iBAApB;AAIH;AACJ;;;gCAEO;AAAA;;AACJ,iBAAKC,OAAL,GAAe,sBAAE,KAAKC,GAAP,CAAf;;AAEA,gBAAIC,SAAS,KAAKjB,KAAL,CAAWkB,WAAX,IAA0B,kBAAOC,IAAP,CAAYC,aAAZ,EAAvC;AACAH,qBAAS,kBAAOE,IAAP,CAAYE,4BAAZ,CAAyCJ,MAAzC,CAAT;;AAEA,iBAAKF,OAAL,CAAaO,cAAb,CAA4B;AACxBL,8BADwB;AAExBM,0BAAU,KAAKvB,KAAL,CAAWuB,QAFG;AAGxBC,0BAAU,KAHc;AAIxBC,uBAAO,KAAKzB,KAAL,CAAWyB,KAAX,IAAoB,KAJH;AAKxBC,yBAAS,KAAK1B,KAAL,CAAW0B,OAAX,GAAqB,IAAIC,IAAJ,CAAS,KAAK3B,KAAL,CAAW0B,OAApB,CAArB,GAAoD,KALrC;AAMxBE,mCAAmB;AACfC,gCAAY,KAAK7B,KAAL,CAAW8B,kBAAX,IAAiC,MAD9B;AAEfC,8BAAU,KAAK/B,KAAL,CAAWgC,gBAAX,IAA+B;AAF1B;AANK,aAA5B,EAUGC,EAVH,CAUM,SAVN,EAUiB,aAAK;AAClB,oBAAI,OAAKhC,YAAT,EAAuB;AACnB,2BAAKiC,QAAL,CAAcC,EAAEC,MAAF,CAASC,KAAvB;AACH;AACD,uBAAKpC,YAAL,GAAoB,KAApB;AACH,aAfD,EAeGgC,EAfH,CAeM,WAfN,EAemB,YAAM;AACrB,uBAAKhC,YAAL,GAAoB,IAApB;AACH,aAjBD;AAkBH;;;iCAEQqC,Q,EAAU;AACf,gBAAIA,QAAJ,EAAc;AACVA,2BAAW,kBAAOnB,IAAP,CAAYoB,IAAZ,CAAiBD,QAAjB,EAA2B,KAAKtC,KAAL,CAAWwC,WAAtC,EAAmD,KAAKxC,KAAL,CAAWkB,WAAX,IAA0B,kBAAOC,IAAP,CAAYC,aAAZ,EAA7E,CAAX;AACH;;AAED,gBAAIkB,aAAa,KAAKtC,KAAL,CAAWqC,KAA5B,EAAmC;AAC/B,qBAAKrC,KAAL,CAAWkC,QAAX,CAAoBI,QAApB,EAA8B,KAAKG,QAAnC;AACH;AACJ;;;wCAEe;AACZ,gBAAI,CAAC,uBAAU,KAAKzC,KAAL,CAAWqC,KAArB,CAAL,EAAkC;AAC9B,uBAAO,kBAAOlB,IAAP,CAAYoB,IAAZ,CAAiB,KAAKvC,KAAL,CAAWqC,KAA5B,EAAmC,KAAKrC,KAAL,CAAWkB,WAA9C,EAA2D,KAAKlB,KAAL,CAAWwC,WAAtE,CAAP;AACH;;AAED,mBAAO,KAAKE,cAAL,EAAP;AACH;;;EAxEc,kBAAOC,EAAP,CAAUC,a;;AA2E7B7C,KAAK8C,YAAL,GAAoB;AAChBX,4BADgB;AAEhBT,WAAO,KAFS;AAGhBqB,cAAU,KAHM;AAIhBC,cAAU,KAJM;AAKhBC,iBAAa,EALG;AAMhB9B,iBAAa,IANG;AAOhBsB,iBAAa,OAPG;AAQhBjB,cAAU,EARM;AAShB0B,YATgB,sBASL;AAAA;;AACP,YAAMC,YAAY,CAAC,cAAD,EAAiB,kBAAjB,EAAqC,gBAArC,EAAuD,eAAvD,EAAwE,MAAxE,EAAgF,UAAhF,EAA4F,MAA5F,EAAoG,UAApG,CAAlB;AACA,YAAMlD,QAAQ,oBAAO,KAAKA,KAAZ,EAAmBkD,SAAnB,CAAd;AAFO,YAGCC,KAHD,GAGiBnD,KAHjB,CAGCmD,KAHD;AAAA,YAGQC,IAHR,GAGiBpD,KAHjB,CAGQoD,IAHR;;AAIPpD,cAAMqC,KAAN,GAAc,KAAKgB,aAAL,EAAd;AACArD,cAAMsD,UAAN,GAAmB,8BAAC,IAAD,IAAM,MAAK,eAAX,GAAnB;AACAtD,cAAMuD,KAAN,GAAc,iBAAS;AACnB,mBAAKvC,GAAL,GAAWJ,KAAX;AACA,mBAAK4C,KAAL;AACH,SAHD;;AAKA,eAAO,8BAAC,KAAD,2BAAO,KAAK;AAAA,uBAAO,OAAK5C,KAAL,GAAa6C,IAApB;AAAA,aAAZ,IAAyCzD,KAAzC,EAAP;AACH;AArBe,CAApB;;kBAwBe,kBAAO0D,eAAP,CAAuB3D,IAAvB,EAA6B;AACxC4D,aAAS,CAAC,MAAD,EAAS,OAAT,EAAkB,+BAAlB;AAD+B,CAA7B,C","file":"index.js","sourcesContent":["import React from 'react';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport { Webiny } from 'webiny-app';\n\nclass Time extends Webiny.Ui.FormComponent {\n    constructor(props) {\n        super(props);\n        this.valueChanged = false;\n\n        this.bindMethods('setup,onChange');\n    }\n\n    shouldComponentUpdate(nextProps, nextState) {\n        if (nextProps['disabledBy']) {\n            return true;\n        }\n\n        const omit = ['children', 'key', 'ref', 'onChange'];\n        const oldProps = _.omit(this.props, omit);\n        const newProps = _.omit(nextProps, omit);\n\n        return !_.isEqual(newProps, oldProps) || !_.isEqual(nextState, this.state);\n    }\n\n    componentDidUpdate(prevProps, prevState) {\n        super.componentDidUpdate();\n        if (prevState.isValid !== this.state.isValid) {\n            this.input.setState({\n                isValid: this.state.isValid,\n                validationMessage: this.state.validationMessage\n            });\n        }\n    }\n\n    setup() {\n        this.element = $(this.dom);\n\n        let format = this.props.inputFormat || Webiny.I18n.getTimeFormat();\n        format = Webiny.I18n.convertPhpToJsDateTimeFormat(format);\n\n        this.element.datetimepicker({\n            format,\n            stepping: this.props.stepping,\n            keepOpen: false,\n            debug: this.props.debug || false,\n            minDate: this.props.minDate ? new Date(this.props.minDate) : false,\n            widgetPositioning: {\n                horizontal: this.props.positionHorizontal || 'auto',\n                vertical: this.props.positionVertical || 'bottom'\n            }\n        }).on('dp.hide', e => {\n            if (this.valueChanged) {\n                this.onChange(e.target.value);\n            }\n            this.valueChanged = false;\n        }).on('dp.change', () => {\n            this.valueChanged = true;\n        });\n    }\n\n    onChange(newValue) {\n        if (newValue) {\n            newValue = Webiny.I18n.time(newValue, this.props.modelFormat, this.props.inputFormat || Webiny.I18n.getTimeFormat());\n        }\n\n        if (newValue !== this.props.value) {\n            this.props.onChange(newValue, this.validate);\n        }\n    }\n\n    renderPreview() {\n        if (!_.isEmpty(this.props.value)) {\n            return Webiny.I18n.time(this.props.value, this.props.inputFormat, this.props.modelFormat);\n        }\n\n        return this.getPlaceholder();\n    }\n}\n\nTime.defaultProps = {\n    onChange: _.noop,\n    debug: false,\n    disabled: false,\n    readOnly: false,\n    placeholder: '',\n    inputFormat: null,\n    modelFormat: 'H:i:s',\n    stepping: 15,\n    renderer() {\n        const omitProps = ['attachToForm', 'attachValidators', 'detachFromForm', 'validateInput', 'form', 'renderer', 'name', 'onChange'];\n        const props = _.omit(this.props, omitProps);\n        const { Input, Icon } = props;\n        props.value = this.renderPreview();\n        props.addonRight = <Icon icon=\"icon-calendar\"/>;\n        props.onRef = input => {\n            this.dom = input;\n            this.setup();\n        };\n\n        return <Input ref={ref => this.input = ref} {...props}/>;\n    }\n};\n\nexport default Webiny.createComponent(Time, {\n    modules: ['Icon', 'Input', 'Webiny/Vendors/DateTimePicker']\n});\n"]}