{"version":3,"sources":["../../../../../src/components/List/Components/MultiActions/DeleteMultiAction.jsx"],"names":["t","namespace","DeleteMultiAction","props","dialogId","map","m","bind","message","data","replace","length","actions","dialog","api","post","defaults","url","ids","then","growler","services","get","response","statusCode","success","count","reload","danger","statusText","hide","render","call","Modal","label","children","content","name","title","formatMessage","onConfirm","Component","defaultProps","params","delete","modules"],"mappings":"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","file":"DeleteMultiAction.js","sourcesContent":["import React from 'react';\nimport _ from 'lodash';\nimport { app, createComponent, i18n } from 'webiny-app';\nimport ModalMultiAction from './ModalMultiAction';\n\nconst t = i18n.namespace(\"Webiny.Ui.List.MultiActions.DeleteMultiAction\");\nclass DeleteMultiAction extends React.Component {\n\n    constructor(props) {\n        super(props);\n\n        this.dialogId = _.uniqueId('delete-multi-action-modal-');\n\n        ['delete', 'formatMessage'].map(m => this[m] = this[m].bind(this));\n    }\n\n    formatMessage() {\n        const { message, data } = this.props;\n        if (_.isFunction(message)) {\n            return message({ data });\n        }\n        return this.props.message.replace('{count}', this.props.data.length);\n    }\n\n    delete({ data, actions, dialog }) {\n        const { api } = this.props.actions;\n        return api.post(api.defaults.url + '/delete', { ids: _.map(data, 'id') }).then(response => {\n            const growler = app.services.get('growler');\n            if (response.statusCode >= 200) {\n                growler.success(t`{count} records deleted successfully!`({ count: data.length }));\n                actions.reload();\n            } else {\n                growler.danger(_.get(response, 'data.message', response.statusText), t`Delete failed`, true);\n            }\n            return dialog.hide();\n        });\n    }\n\n    render() {\n        if (this.props.render) {\n            return this.props.render.call(this);\n        }\n\n        const { Modal, actions, label, data, children } = this.props;\n\n        const content = _.isFunction(children) ? children : ({ data, actions, dialog }) => {\n            const props = {\n                name: this.dialogId,\n                title: this.props.title,\n                message: this.formatMessage(),\n                onConfirm: () => this.props.onConfirm.call(this, { data, actions, dialog })\n            };\n            return (\n                <Modal.Confirmation {...props}/>\n            );\n        };\n\n        return (\n            <ModalMultiAction actions={actions} label={label} data={data}>\n                {content}\n            </ModalMultiAction>\n        );\n    }\n}\n\nDeleteMultiAction.defaultProps = {\n    label: t`Delete`,\n    title: t`Delete confirmation`,\n    message: t`Do you really want to delete {count} record(s)?`,\n    actions: null,\n    data: [],\n    onConfirm(params) {\n        return this.delete(params);\n    }\n};\n\nexport default createComponent(DeleteMultiAction, { modules: ['Modal'] });"]}