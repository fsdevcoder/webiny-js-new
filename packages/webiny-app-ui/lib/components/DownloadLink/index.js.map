{"version":3,"sources":["../../../src/components/DownloadLink/index.js"],"names":["DownloadLink","props","state","showDialog","dialog","getDialog","bind","result","download","downloader","data","params","setState","render","call","Downloader","Link","onClick","disabled","method","cloneElement","onHidden","onComponentDidMount","show","children","Component","defaultProps","modules"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AAEA;;;;IAEMA,Y;;;AACF,0BAAYC,KAAZ,EAAmB;AAAA;;AAAA,8IACTA,KADS;;AAGf,cAAKC,KAAL,GAAa;AACTC,wBAAY;AADH,SAAb;;AAIA,cAAKC,MAAL,GAAc,IAAd;;AAEA,cAAKC,SAAL,GAAiB,MAAKA,SAAL,CAAeC,IAAf,OAAjB;AATe;AAUlB;;;;oDAE2B;AACxB,gBAAI,KAAKF,MAAT,EAAiB;AACb,qBAAKC,SAAL;AACH;AACJ;;;oCAEW;AACR,gBAAME,SAAS,KAAKN,KAAL,CAAWO,QAAX,CAAoB;AAC/BA,0BAAU,KAAKC,UAAL,CAAgBD,QADK;AAE/BE,sBAAM,KAAKT,KAAL,CAAWU,MAAX,IAAqB;AAFI,aAApB,CAAf;AAIA;AACA,gBAAIJ,MAAJ,EAAY;AACR,qBAAKH,MAAL,GAAcG,MAAd;AACA,qBAAKK,QAAL,CAAc,EAAET,YAAY,IAAd,EAAd;AACH;AACJ;;;iCAEQ;AAAA;;AACL,gBAAI,KAAKF,KAAL,CAAWY,MAAf,EAAuB;AACnB,uBAAO,KAAKZ,KAAL,CAAWY,MAAX,CAAkBC,IAAlB,CAAuB,IAAvB,CAAP;AACH;;AAHI,yBAKkC,KAAKb,KALvC;AAAA,gBAKGc,UALH,UAKGA,UALH;AAAA,gBAKeC,IALf,UAKeA,IALf;AAAA,gBAKwBf,KALxB;;AAML,gBAAMQ,aAAa,8BAAC,UAAD,IAAY,SAAS;AAAA,2BAAe,OAAKA,UAAL,GAAkBA,UAAjC;AAAA,iBAArB,GAAnB;AACAR,kBAAMgB,OAAN,GAAgB,YAAM;AAClB,oBAAI,OAAKhB,KAAL,CAAWiB,QAAf,EAAyB;AACrB;AACH;AACD,oBAAI,wBAAW,OAAKjB,KAAL,CAAWO,QAAtB,CAAJ,EAAqC;AACjC,2BAAKC,UAAL,CAAgBD,QAAhB,CAAyB,OAAKP,KAAL,CAAWkB,MAApC,EAA4C,OAAKlB,KAAL,CAAWO,QAAvD,EAAiE,OAAKP,KAAL,CAAWU,MAA5E;AACH,iBAFD,MAEO;AACH,2BAAKN,SAAL;AACH;AACJ,aATD;AAUA,mBAAOJ,MAAM,UAAN,CAAP;;AAEA,gBAAIG,SAAS,IAAb;AACA,gBAAI,KAAKA,MAAT,EAAiB;AACbA,yBAAS,gBAAMgB,YAAN,CAAmB,KAAKhB,MAAxB,EAAgC;AACrCiB,8BAAU,oBAAM;AACZ,+BAAKjB,MAAL,GAAc,IAAd;AACA,+BAAKQ,QAAL,CAAc,EAAET,YAAY,KAAd,EAAd;AACH,qBAJoC;AAKrCmB,yCAAqB,qCAAU;AAC3B,4BAAI,OAAKpB,KAAL,CAAWC,UAAf,EAA2B;AACvBC,mCAAOmB,IAAP;AACH;AACJ;AAToC,iBAAhC,CAAT;AAWH;;AAED,mBACI;AAAC,oBAAD;AAAU,oCAAOtB,KAAP,EAAc,CAAC,QAAD,CAAd,CAAV;AACK,qBAAKA,KAAL,CAAWuB,QADhB;AAEKf,0BAFL;AAGKL;AAHL,aADJ;AAOH;;;EAxEsB,gBAAMqB,S;;AA2EjCzB,aAAa0B,YAAb,GAA4B;AACxBlB,cAAU,IADc;AAExBW,YAAQ,KAFgB;AAGxBR,YAAQ,IAHgB;AAIxBO,cAAU;AAJc,CAA5B;;kBAOe,gCAAgBlB,YAAhB,EAA8B,EAAE2B,SAAS,CAAC,YAAD,EAAe,MAAf,CAAX,EAA9B,C","file":"index.js","sourcesContent":["import React from \"react\";\nimport _ from \"lodash\";\nimport { createComponent } from \"webiny-app\";\n\nclass DownloadLink extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            showDialog: false\n        };\n\n        this.dialog = null;\n\n        this.getDialog = this.getDialog.bind(this);\n    }\n\n    componentWillReceiveProps() {\n        if (this.dialog) {\n            this.getDialog();\n        }\n    }\n\n    getDialog() {\n        const result = this.props.download({\n            download: this.downloader.download,\n            data: this.props.params || null\n        });\n        // At this point we do not want to import Modal component to perform the check so we assume it is a ModalDialog if it is not null\n        if (result) {\n            this.dialog = result;\n            this.setState({ showDialog: true });\n        }\n    }\n\n    render() {\n        if (this.props.render) {\n            return this.props.render.call(this);\n        }\n\n        const { Downloader, Link, ...props } = this.props;\n        const downloader = <Downloader onReady={downloader => (this.downloader = downloader)} />;\n        props.onClick = () => {\n            if (this.props.disabled) {\n                return;\n            }\n            if (_.isString(this.props.download)) {\n                this.downloader.download(this.props.method, this.props.download, this.props.params);\n            } else {\n                this.getDialog();\n            }\n        };\n        delete props[\"download\"];\n\n        let dialog = null;\n        if (this.dialog) {\n            dialog = React.cloneElement(this.dialog, {\n                onHidden: () => {\n                    this.dialog = null;\n                    this.setState({ showDialog: false });\n                },\n                onComponentDidMount: dialog => {\n                    if (this.state.showDialog) {\n                        dialog.show();\n                    }\n                }\n            });\n        }\n\n        return (\n            <Link {..._.omit(props, [\"render\"])}>\n                {this.props.children}\n                {downloader}\n                {dialog}\n            </Link>\n        );\n    }\n}\n\nDownloadLink.defaultProps = {\n    download: null,\n    method: \"GET\",\n    params: null,\n    disabled: false\n};\n\nexport default createComponent(DownloadLink, { modules: [\"Downloader\", \"Link\"] });\n"]}