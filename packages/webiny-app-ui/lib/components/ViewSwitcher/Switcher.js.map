{"version":3,"sources":["../../../src/components/ViewSwitcher/Switcher.jsx"],"names":["Switcher","props","views","defaultView","viewProps","container","attachView","view","detachView","map","m","bind","show","name","params","undefined","persist","nextView","console","warn","Promise","resolve","modal","isShown","hide","cloneElement","key","render","call","Children","children","renderView","Component"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AAEA;;AACA;;;;;;IAEMA,Q;;;AACF,sBAAYC,KAAZ,EAAmB;AAAA;;AAAA,sIACTA,KADS;;AAGf,cAAKC,KAAL,GAAa,EAAb;AACA,cAAKC,WAAL,GAAmB,IAAnB;AACA,cAAKC,SAAL,GAAiB;AACbC,4BADa;AAEbC,wBAAY,0BAAQ;AAChB,sBAAKJ,KAAL,CAAWK,KAAKN,KAAL,CAAWM,IAAtB,IAA8BA,IAA9B;AACH,aAJY;AAKbC,wBAAY,0BAAQ;AAChB,uBAAO,MAAKN,KAAL,CAAWK,KAAKN,KAAL,CAAWM,IAAtB,CAAP;AACH;AAPY,SAAjB;;AAUA,SAAC,UAAD,EAAa,YAAb,EAA2BE,GAA3B,CAA+B;AAAA,mBAAK,MAAKC,CAAL,IAAU,MAAKA,CAAL,EAAQC,IAAR,OAAf;AAAA,SAA/B;AAfe;AAgBlB;;;;4CAEmB;AAChB,gBAAI,KAAKR,WAAT,EAAsB;AAClB,qBAAKD,KAAL,CAAW,KAAKC,WAAhB,EAA6BS,IAA7B;AACH;AACJ;;;iCAEQC,I,EAAM;AAAA;;AACX,mBAAO,YAAiB;AAAA,oBAAhBC,MAAgB,uEAAP,EAAO;;AACpB,oBAAIA,WAAWC,SAAX,IAAwB,0BAAaD,OAAOE,OAApB,CAA5B,EAA0D;AACtDF,6BAAS,EAAT;AACH;;AAED,oBAAMG,WAAW,OAAKf,KAAL,CAAWW,IAAX,CAAjB;AACA,oBAAI,CAACI,QAAL,EAAe;AACXC,4BAAQC,IAAR,CAAa,oBAAoBN,IAApB,GAA2B,mCAAxC;AACA,2BAAOO,QAAQC,OAAR,EAAP;AACH;;AAED,oBAAI,CAACJ,SAAShB,KAAT,CAAeqB,KAApB,EAA2B;AACvB;AACA,wCAAO,OAAKpB,KAAZ,EAAmB,gBAAQ;AACvB,4BAAIK,KAAKgB,OAAL,EAAJ,EAAoB;AAChBhB,iCAAKiB,IAAL;AACH;AACJ,qBAJD;AAKH;AACD,uBAAOJ,QAAQC,OAAR,CAAgBJ,SAASL,IAAT,CAAcE,MAAd,CAAhB,CAAP;AACH,aApBD;AAqBH;;;mCAEUP,I,EAAM;AACb,gBAAI,gCAAgBA,IAAhB,iBAAJ,EAAiC;AAC7B,oBAAIA,KAAKN,KAAL,CAAWE,WAAf,EAA4B;AACxB,yBAAKA,WAAL,GAAmBI,KAAKN,KAAL,CAAWM,IAA9B;AACH;AACD,uBAAO,gBAAMkB,YAAN,CAAmBlB,IAAnB,EAAyB,sBAAS,EAAT,EAAa,KAAKH,SAAlB,EAA6B,EAAEsB,KAAKnB,KAAKN,KAAL,CAAWM,IAAlB,EAA7B,CAAzB,CAAP;AACH;AACD,mBAAO,IAAP;AACH;;;iCAEQ;AACL,gBAAI,KAAKN,KAAL,CAAW0B,MAAf,EAAuB;AACnB,uBAAO,KAAK1B,KAAL,CAAW0B,MAAX,CAAkBC,IAAlB,CAAuB,IAAvB,CAAP;AACH;;AAED,mBACI;AAAA;AAAA;AAAuB,gCAAMC,QAAN,CAAepB,GAAf,CAAmB,KAAKR,KAAL,CAAW6B,QAA9B,EAAwC,KAAKC,UAA7C;AAAvB,aADJ;AAGH;;;EAnEkB,gBAAMC,S;;kBAsEd,gCAAgBhC,QAAhB,C","file":"Switcher.js","sourcesContent":["import React from 'react';\nimport _ from 'lodash';\nimport { createComponent, isElementOfType } from 'webiny-app';\nimport View from './View';\n\nclass Switcher extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.views = {};\n        this.defaultView = null;\n        this.viewProps = {\n            container: this,\n            attachView: view => {\n                this.views[view.props.view] = view;\n            },\n            detachView: view => {\n                delete this.views[view.props.view];\n            }\n        };\n\n        ['showView', 'renderView'].map(m => this[m] = this[m].bind(this));\n    }\n\n    componentDidMount() {\n        if (this.defaultView) {\n            this.views[this.defaultView].show();\n        }\n    }\n\n    showView(name) {\n        return (params = {}) => {\n            if (params !== undefined && _.isFunction(params.persist)) {\n                params = {};\n            }\n\n            const nextView = this.views[name];\n            if (!nextView) {\n                console.warn(\"Warning: view '\" + name + \"' was not found in ViewContainer!\");\n                return Promise.resolve();\n            }\n\n            if (!nextView.props.modal) {\n                // Hide all currently shown views\n                _.each(this.views, view => {\n                    if (view.isShown()) {\n                        view.hide();\n                    }\n                });\n            }\n            return Promise.resolve(nextView.show(params));\n        };\n    }\n\n    renderView(view) {\n        if (isElementOfType(view, View)) {\n            if (view.props.defaultView) {\n                this.defaultView = view.props.view;\n            }\n            return React.cloneElement(view, _.assign({}, this.viewProps, { key: view.props.view }));\n        }\n        return null;\n    }\n\n    render() {\n        if (this.props.render) {\n            return this.props.render.call(this);\n        }\n\n        return (\n            <webiny-view-switcher>{React.Children.map(this.props.children, this.renderView)}</webiny-view-switcher>\n        );\n    }\n}\n\nexport default createComponent(Switcher);\n"]}