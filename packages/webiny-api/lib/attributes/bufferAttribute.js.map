{"version":3,"sources":["../../src/attributes/bufferAttribute.js"],"names":["BufferAttribute","constructor","name","encoding","validateType","value","Buffer","startsWith","expected","setValue","from","split","pop","prototype","call"],"mappings":";;;;;;;;;;AACA;;;;AAEA,MAAMA,eAAN,gCAAwC;;AAGpCC,gBAAYC,IAAZ,EAA0BC,QAA1B,EAA8D;AAC1D,cAAMD,IAAN;AACA,aAAKC,QAAL,GAAgBA,QAAhB;AACH;;AAEKC,gBAAN,CAAmBC,KAAnB,EAAiC;AAAA;;AAAA;AAC7B,gBAAIA,iBAAiBC,MAArB,EAA6B;AACzB;AACH;;AAED,gBAAI,OAAOD,KAAP,KAAiB,QAAjB,IAA6BA,MAAME,UAAN,CAAiB,OAAjB,CAAjC,EAA4D;AACxD;AACH;;AAED,kBAAKC,QAAL,CAAc,2BAAd,EAA2C,OAAOH,KAAlD;AAT6B;AAUhC;;AAED;AACMI,YAAN,CAAeJ,KAAf,EAAsB;AAAA;;AAAA;AAClB,gBAAI,OAAOA,KAAP,KAAiB,QAArB,EAA+B;AAC3BA,wBAAQC,OAAOI,IAAP,CAAYL,MAAMM,KAAN,CAAY,GAAZ,EAAiBC,GAAjB,EAAZ,EAAoC,OAAKT,QAAzC,CAAR;AACH;AACD,mBAAO,uBAAUU,SAAV,CAAoBJ,QAApB,CAA6BK,IAA7B,SAAwCT,KAAxC,CAAP;AAJkB;AAKrB;AA1BmC;kBA6BzBL,e","file":"bufferAttribute.js","sourcesContent":["// @flow\nimport { Attribute } from \"webiny-model\";\n\nclass BufferAttribute extends Attribute {\n    encoding: buffer$NonBufferEncoding;\n\n    constructor(name: string, encoding: buffer$NonBufferEncoding) {\n        super(name);\n        this.encoding = encoding;\n    }\n\n    async validateType(value: mixed) {\n        if (value instanceof Buffer) {\n            return;\n        }\n\n        if (typeof value === \"string\" && value.startsWith(\"data:\")) {\n            return;\n        }\n\n        this.expected(\"Buffer or data URI string\", typeof value);\n    }\n\n    // $FlowIgnore\n    async setValue(value) {\n        if (typeof value === \"string\") {\n            value = Buffer.from(value.split(\",\").pop(), this.encoding);\n        }\n        return Attribute.prototype.setValue.call(this, value);\n    }\n}\n\nexport default BufferAttribute;\n"]}