{"version":3,"sources":["../../../src/components/Navigation/Mobile.js"],"names":["Mobile","props","state","menu","services","get","onClick","bind","renderer","canAccess","level","Link","children","Children","toArray","hasChildren","length","menuIconClass","icon","linkProps","key","id","label","closeMobileMenu","childMenuItems","map","child","i","cloneElement","render","filter","item","e","className","open","active","findRoute","router","route","name","getLink","stopPropagation","setState","removeClass","getMenu","Component","modules"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;AAEA;;;;AACA;;;;;;IAEMA,M;;;AACF,oBAAYC,KAAZ,EAAmB;AAAA;;AAAA,kIACTA,KADS;;AAGf,cAAKC,KAAL,GAAa,EAAb;AACA,cAAKC,IAAL,GAAY,eAAIC,QAAJ,CAAaC,GAAb,CAAiB,MAAjB,CAAZ;;AAEA,cAAKC,OAAL,GAAe,MAAKA,OAAL,CAAaC,IAAb,OAAf;;AAEA;;;;AAIA,cAAKC,QAAL,GAAgB,UAACL,IAAD,EAAU;AACtB,gBAAMF,QAAQ,qBAAQE,KAAKF,KAAb,CAAd;AACA,gBAAI,CAAC,gBAAMQ,SAAN,CAAgBR,KAAhB,CAAL,EAA6B;AACzB,uBAAO,IAAP;AACH;;AAJqB,gBAMdS,KANc,GAMJT,KANI,CAMdS,KANc;AAAA,gBAOdC,IAPc,GAOL,MAAKV,KAPA,CAOdU,IAPc;;AAQtB,gBAAMC,WAAW,gBAAMC,QAAN,CAAeC,OAAf,CAAuBb,MAAMW,QAA7B,CAAjB;AACA,gBAAMG,cAAcH,SAASI,MAAT,GAAkB,CAAtC;;AAEA,gBAAMC,gBAAgB,0BAAS,eAAT,EAA0B,EAAE,MAAM,wBAAWhB,MAAMiB,IAAjB,EAAuB,KAAvB,CAAR,EAA1B,EAAmEjB,MAAMiB,IAAzE,CAAtB;;AAEA,gBAAMC,YAAY;AACdC,qBAAKnB,MAAMoB,EADG;AAEdC,uBAAOrB,MAAMqB,KAFC;AAGdhB,yBAAS,MAAKiB,eAHA;AAIdX,0BAAU,CACNX,MAAMiB,IAAN,GAAa,wCAAM,KAAI,MAAV,EAAiB,WAAWD,aAA5B,GAAb,GAA4D,IADtD,EAENP,QAAQ,CAAR,GAAYT,MAAMqB,KAAlB,GAA0B;AAAA;AAAA,sBAAM,KAAI,OAAV,EAAkB,WAAU,WAA5B;AAAyCrB,0BAAMqB;AAA/C,iBAFpB,EAGNP,cAAc,wCAAM,KAAI,OAAV,EAAkB,WAAU,mCAA5B,GAAd,GAAkF,IAH5E;AAJI,aAAlB;;AAWA,gBAAIS,iBAAiB,IAArB;AACA,gBAAIT,WAAJ,EAAiB;AACb;AACAS,iCAAiBZ,SAASa,GAAT,CAAa,UAACC,KAAD,EAAQC,CAAR,EAAc;AACxC,wBAAI,CAAC,gBAAMlB,SAAN,CAAgBiB,MAAMzB,KAAtB,CAAL,EAAmC;AAC/B,+BAAO,IAAP;AACH;;AAED,2BAAO,gBAAM2B,YAAN,CAAmBF,KAAnB,EAA0B,EAAEN,KAAKO,CAAP,EAAUE,QAAQ,MAAKrB,QAAvB,EAA1B,CAAP;AACH,iBANgB,CAAjB;;AAQA;AACA,oBAAI,CAACgB,eAAeM,MAAf,CAAsB;AAAA,2BAAQ,CAAC,qBAAQC,IAAR,CAAT;AAAA,iBAAtB,EAA8Cf,MAAnD,EAA2D;AACvD,2BAAO,IAAP;AACH;AACDG,0BAAUb,OAAV,GAAoB;AAAA,2BAAK,MAAKA,OAAL,CAAaH,IAAb,EAAmB6B,CAAnB,CAAL;AAAA,iBAApB;AACH;;AAED,gBAAMC,YAAY,0BAAS;AACvBC,sBAAM,MAAKhC,KAAL,CAAWD,MAAMoB,EAAjB,CADiB;AAEvBc,wBAAQlC,MAAMS,KAAN,KAAgB,CAAhB,GAAoB,gBAAM0B,SAAN,CAAgBnC,KAAhB,EAAuB,eAAIoC,MAAJ,CAAWC,KAAX,CAAiBC,IAAxC,CAApB,GAAoE;AAFrD,aAAT,CAAlB;;AAKA,mBACI;AAAA;AAAA,kBAAI,WAAWN,SAAf,EAA0B,KAAKhC,MAAMoB,EAArC;AACK,gCAAMmB,OAAN,CAAcvC,MAAMqC,KAApB,EAA2B3B,IAA3B,EAAiCQ,SAAjC,CADL;AAEKJ,+BACG;AAAA;AAAA,sBAAI,WAAW,YAAYL,QAAQ,CAApB,CAAf;AACI;AAAA;AAAA,0BAAI,WAAU,uBAAd,EAAsC,SAAS;AAAA,uCAAK,MAAKJ,OAAL,CAAaH,IAAb,EAAmB6B,CAAnB,CAAL;AAAA,6BAA/C;AAAA;AAAA,qBADJ;AAEKR;AAFL;AAHR,aADJ;AAWH,SA1DD;AAZe;AAuElB;;;;gCAEOrB,I,EAAM6B,C,EAAG;AACbA,cAAES,eAAF;AACA,gBAAMvC,QAAQ,KAAKA,KAAnB;AACAA,kBAAMC,KAAKF,KAAL,CAAWoB,EAAjB,IAAuB,CAAC,mBAAMnB,KAAN,EAAaC,KAAKF,KAAL,CAAWoB,EAAxB,EAA4B,KAA5B,CAAxB;AACA,iBAAKqB,QAAL,CAAcxC,KAAd;AACH;;;0CAEiB;AACd,kCAAE,MAAF,EAAUyC,WAAV,CAAsB,YAAtB;AACH;;;iCAEQ;AAAA;;AACL,mBACI;AAAA;AAAA,kBAAK,WAAU,YAAf;AACI,uDAAK,WAAU,QAAf,GADJ;AAEI;AAAA;AAAA,sBAAK,WAAU,WAAf;AACI;AAAA;AAAA,0BAAI,WAAU,mBAAd;AACI;AAAA;AAAA,8BAAI,WAAU,kBAAd,EAAiC,SAAS,KAAKpB,eAA/C;AAAA;AAAA,yBADJ;AAEK,6BAAKpB,IAAL,CAAUyC,OAAV,GAAoBnB,GAApB,CAAwB;AAAA,mCACrB,gBAAMG,YAAN,CAAmBzB,IAAnB,EAAyB;AACrBiB,qCAAKjB,KAAKF,KAAL,CAAWoB,EADK;AAErBQ,wCAAQ,OAAKrB;AAFQ,6BAAzB,CADqB;AAAA,yBAAxB;AAFL;AADJ;AAFJ,aADJ;AAgBH;;;EAtGgB,gBAAMqC,S;;kBAyGZ,gCAAgB7C,MAAhB,EAAwB,EAAE8C,SAAS,CAAC,MAAD,CAAX,EAAxB,C","file":"Mobile.js","sourcesContent":["import React from 'react';\nimport classSet from \"classnames\";\nimport { app, createComponent } from 'webiny-app';\nimport _ from 'lodash';\nimport $ from 'jquery';\nimport utils from './utils';\n\nclass Mobile extends React.Component {\n    constructor(props) {\n        super(props);\n\n        this.state = {};\n        this.menu = app.services.get('menu');\n\n        this.onClick = this.onClick.bind(this);\n\n        /**\n         * Menu renderer passed to <Menu>.\n         * Note that `this` is still bound to `Mobile` class since we are passing an arrow function.\n         */\n        this.renderer = (menu) => {\n            const props = _.clone(menu.props);\n            if (!utils.canAccess(props)) {\n                return null;\n            }\n\n            const { level } = props;\n            const { Link } = this.props;\n            const children = React.Children.toArray(props.children);\n            const hasChildren = children.length > 0;\n\n            const menuIconClass = classSet('icon app-icon', { 'fa': _.includes(props.icon, 'fa-') }, props.icon);\n\n            const linkProps = {\n                key: props.id,\n                label: props.label,\n                onClick: this.closeMobileMenu,\n                children: [\n                    props.icon ? <span key=\"icon\" className={menuIconClass}/> : null,\n                    level > 1 ? props.label : <span key=\"title\" className=\"app-title\">{props.label}</span>,\n                    hasChildren ? <span key=\"caret\" className=\"icon icon-caret-down mobile-caret\"/> : null\n                ]\n            };\n\n            let childMenuItems = null;\n            if (hasChildren) {\n                // Build array of child items and check their access roles.\n                childMenuItems = children.map((child, i) => {\n                    if (!utils.canAccess(child.props)) {\n                        return null;\n                    }\n\n                    return React.cloneElement(child, { key: i, render: this.renderer });\n                });\n\n                // If no child items are there to render - hide parent menu as well.\n                if (!childMenuItems.filter(item => !_.isNil(item)).length) {\n                    return null;\n                }\n                linkProps.onClick = e => this.onClick(menu, e);\n            }\n\n            const className = classSet({\n                open: this.state[props.id],\n                active: props.level === 0 ? utils.findRoute(props, app.router.route.name) : false\n            });\n\n            return (\n                <li className={className} key={props.id}>\n                    {utils.getLink(props.route, Link, linkProps)}\n                    {hasChildren && (\n                        <ul className={'level-' + (level + 1)}>\n                            <li className=\"main-menu--close back\" onClick={e => this.onClick(menu, e)}>Go Back</li>\n                            {childMenuItems}\n                        </ul>\n                    )}\n                </li>\n            );\n        };\n    }\n\n    onClick(menu, e) {\n        e.stopPropagation();\n        const state = this.state;\n        state[menu.props.id] = !_.get(state, menu.props.id, false);\n        this.setState(state);\n    }\n\n    closeMobileMenu() {\n        $('body').removeClass('mobile-nav');\n    }\n\n    render() {\n        return (\n            <div className=\"navigation\">\n                <div className=\"shield\"/>\n                <div className=\"main-menu\">\n                    <ul className=\"menu-list level-0\">\n                        <li className=\"main-menu--close\" onClick={this.closeMobileMenu}>Close</li>\n                        {this.menu.getMenu().map(menu => (\n                            React.cloneElement(menu, {\n                                key: menu.props.id,\n                                render: this.renderer\n                            })\n                        ))}\n                    </ul>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default createComponent(Mobile, { modules: ['Link'] });"]}