{"version":3,"sources":["../src/app.js"],"names":["defaultConfig","security","authentication","cookie","identities","identity","authenticate","strategy","apiMethod","onLogout","router","goToRoute","config","params","next","Promise","all","res","then","services","add","addRoute","name","path","component","modules","load","title","register","factory","tags"],"mappings":"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","file":"app.js","sourcesContent":["import { app } from \"webiny-app\";\nimport { app as uiApp } from \"webiny-app-ui\";\nimport { app as securityApp } from \"webiny-app-security\";\nimport Menu from \"./services/menu\";\n\n\nconst defaultConfig = {\n    security: {\n        authentication: {\n            cookie: \"webiny-token\",\n            identities: [\n                {\n                    identity: \"user\",\n                    authenticate: [\n                        {\n                            strategy: \"credentials\",\n                            apiMethod: \"/security/auth/login-user\"\n                        }\n                    ]\n                }\n            ],\n            onLogout() {\n                app.router.goToRoute(\"Login\");\n            }\n        }\n    }\n};\n\nexport default (config = defaultConfig) => {\n    return (params, next) => {\n        Promise.all([\n            new Promise(res => uiApp()(params, res)),\n            new Promise(res => securityApp(config.security)(params, res))\n        ]).then(() => {\n            app.services.add(\"menu\", () => new Menu());\n\n            app.router.addRoute({\n                name: \"Me.Account\",\n                path: \"/me/account\",\n                component: () => app.modules.load(\"Skeleton.UserAccountForm\"),\n                title: \"My Account\"\n            });\n\n            app.modules.register([\n                {\n                    name: \"Skeleton.AdminLayout\",\n                    factory: () => import(\"./components/Layouts/AdminLayout\")\n                },\n                {\n                    name: \"Skeleton.EmptyLayout\",\n                    factory: () => import(\"./components/Layouts/EmptyLayout\")\n                },\n                {\n                    name: \"Skeleton.UserAccountForm\",\n                    factory: () => import(\"./components/UserAccount/UserAccountForm\")\n                },\n                {\n                    name: \"Skeleton.Header\",\n                    factory: () => import(\"./components/Header\")\n                },\n                {\n                    name: \"Skeleton.Footer\",\n                    factory: () => import(\"./components/Footer\")\n                },\n                {\n                    name: \"Skeleton.Logo\",\n                    factory: () => import(\"./components/Logo\")\n                },\n                {\n                    name: \"Skeleton.Navigation\",\n                    factory: () => import(\"./components/Navigation\")\n                },\n                {\n                    name: \"Skeleton.Navigation.Desktop\",\n                    factory: () => import(\"./components/Navigation/Desktop\")\n                },\n                {\n                    name: \"Skeleton.Navigation.Mobile\",\n                    factory: () => import(\"./components/Navigation/Mobile\")\n                },\n                {\n                    name: \"Skeleton.UserMenu\",\n                    factory: () => import(\"./components/UserMenu\")\n                },\n                {\n                    name: \"Skeleton.Login\",\n                    factory: () => import(\"./views/security/Login\")\n                },\n                {\n                    name: \"Skeleton.UserMenu.AccountPreferences\",\n                    factory: () => import(\"./components/UserMenu/AccountPreferences\"),\n                    tags: [\"user-menu-item\"]\n                },\n                {\n                    name: \"Skeleton.UserMenu.Logout\",\n                    factory: () => import(\"./components/UserMenu/Logout\"),\n                    tags: [\"user-logout-menu-item\"]\n                }\n            ]);\n\n            next()\n        });\n    };\n};\n"]}