{"version":3,"sources":["../../../../../src/Modules/I18N/Views/TranslationsList/ImportTranslationsModal.jsx"],"names":["ImportTranslationsModal","Ui","props","options","results","model","form","showLoading","preview","setModel","response","extension","file","name","split","pop","api","post","hideLoading","isError","handleApiError","data","getData","onTranslationsImported","i18n","num","created","updated","ignored","hide","submit","ModalComponent","defaultProps","assign","noop","createComponent","modulesProp","modules"],"mappings":"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","file":"ImportTranslationsModal.js","sourcesContent":["import React from 'react';\nimport {Webiny} from 'webiny-client';\nimport _ from 'lodash';\n\n/**\n * @i18n.namespace Webiny.Backend.I18N.ImportTranslationsModal\n */\nclass ImportTranslationsModal extends Webiny.Ui.ModalComponent {\n    renderDialog() {\n        const {Ui} = this.props;\n\n        return (\n            <Ui.Modal.Dialog>\n                <Ui.Form\n                    api=\"/entities/webiny/i18n-texts\"\n                    url=\"/translations/import\"\n                    defaultModel={{options: {}, results: null}}\n                    onSubmit={async ({model, form}) => {\n                        form.showLoading();\n                        const preview = model.options.preview;\n                        form.setModel({response: null});\n                        const extension = model.file.name.split('.').pop();\n                        const response = await form.api.post('/translations/import/' + extension, model);\n                        form.hideLoading();\n\n                        if (response.isError()) {\n                            return form.handleApiError(response);\n                        }\n\n                        form.setModel({results: {preview, data: response.getData()}}, () => !preview && this.props.onTranslationsImported());\n                    }}>\n                    {({model, form}) => {\n                        let results = null;\n                        if (model.results) {\n                            if (model.results.preview) {\n                                results = (\n                                    <Ui.Alert>\n                                        {this.i18n('Export file is valid. After importing, following changes will be applied:')}\n                                        <ul>\n                                            <li>{this.i18n('{num} created', {num: <strong>{model.results.data.created}</strong>})}</li>\n                                            <li>{this.i18n('{num} updated', {num: <strong>{model.results.data.updated}</strong>})}</li>\n                                            <li>{this.i18n('{num} ignored', {num: <strong>{model.results.data.ignored}</strong>})}</li>\n                                        </ul>\n                                    </Ui.Alert>\n                                );\n                            } else {\n                                results = (\n                                    <Ui.Alert type=\"success\">\n                                        {this.i18n('Translations were successfully imported! Following changes were applied:')}\n                                        <ul>\n                                            <li>{this.i18n('{num} created', {num: <strong>{model.results.data.created}</strong>})}</li>\n                                            <li>{this.i18n('{num} updated', {num: <strong>{model.results.data.updated}</strong>})}</li>\n                                            <li>{this.i18n('{num} ignored', {num: <strong>{model.results.data.ignored}</strong>})}</li>\n                                        </ul>\n                                    </Ui.Alert>\n                                );\n                            }\n                        }\n                        return (\n                            <Ui.Modal.Content>\n                                <Ui.Form.Loader/>\n                                <Ui.Modal.Header title={this.i18n(`Import translations`)} onClose={this.hide}/>\n                                <Ui.Modal.Body>\n                                    <Ui.Form.Error/>\n                                    {results}\n                                    <Ui.Grid.Row>\n                                        <Ui.Grid.Col all={12}>\n                                            <Ui.File\n                                                validate=\"required\"\n                                                placeholder={this.i18n('JSON or YAML file')}\n                                                label={this.i18n('Choose File')}\n                                                name=\"file\"/>\n                                        </Ui.Grid.Col>\n                                    </Ui.Grid.Row>\n\n                                    <Ui.Section title={this.i18n('Options')}/>\n                                    <Ui.Grid.Row>\n                                        <Ui.Grid.Col all={12}>\n                                            <Ui.Checkbox name=\"options.preview\" label={this.i18n('Preview')}/>\n                                        </Ui.Grid.Col>\n                                    </Ui.Grid.Row>\n\n                                </Ui.Modal.Body>\n                                <Ui.Modal.Footer >\n                                    <Ui.Button label={this.i18n(`Cancel`)} onClick={this.hide}/>\n                                    <Ui.Button\n                                        type=\"primary\"\n                                        label={this.i18n(`Import`)}\n                                        onClick={form.submit}/>\n                                </Ui.Modal.Footer>\n                            </Ui.Modal.Content>\n                        );\n                    }}\n                </Ui.Form>\n            </Ui.Modal.Dialog>\n        );\n    }\n}\n\nImportTranslationsModal.defaultProps = _.assign({}, Webiny.Ui.ModalComponent.defaultProps, {\n    onTranslationsImported: _.noop\n});\n\nexport default Webiny.createComponent(ImportTranslationsModal, {\n    modulesProp: 'Ui',\n    modules: ['Modal', 'Form', 'Grid', 'Checkbox', 'Button', 'File', 'Section', 'Alert']\n});"]}