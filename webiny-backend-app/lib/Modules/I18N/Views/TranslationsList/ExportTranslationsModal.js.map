{"version":3,"sources":["../../../../../src/Modules/I18N/Views/TranslationsList/ExportTranslationsModal.jsx"],"names":["ExportTranslationsModal","state","groups","I18n","getTextGroups","then","setState","apps","output","id","name","forEach","includes","group","app","push","Ui","props","fileType","model","availableGroups","getAvailableGroups","downloadUrl","Config","ApiUrl","i18n","hide","isEmpty","locales","ModalComponent","defaultProps","assign","createComponent","modulesProp","modules"],"mappings":"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","file":"ExportTranslationsModal.js","sourcesContent":["import React from 'react';\nimport {Webiny} from 'webiny-client';\nimport _ from 'lodash';\n\n/**\n * @i18n.namespace Webiny.Backend.I18N.ExportTranslationsModal\n */\nclass ExportTranslationsModal extends Webiny.Ui.ModalComponent {\n    constructor() {\n        super();\n        this.state = {groups: []};\n    }\n\n    componentWillMount() {\n        super.componentWillMount();\n        Webiny.I18n.getTextGroups().then(groups => this.setState({groups}));\n    }\n\n    getAvailableGroups(apps) {\n        const output = [{id: 'none', name: 'Texts without group'}];\n        this.state.groups.forEach(group => {\n            if (_.includes(apps, group.app)) {\n                output.push(group);\n            }\n        });\n\n        return output;\n    }\n\n    renderDialog() {\n        const {Ui} = this.props;\n\n        return (\n            <Ui.Modal.Dialog>\n                <Ui.Form defaultModel={{fileType: 'json'}}>\n                    {({model}) => {\n                        const availableGroups = this.getAvailableGroups(model.apps);\n                        const downloadUrl = `${Webiny.Config.ApiUrl}/entities/webiny/i18n-texts/translations/export/${model.fileType}`;\n\n                        return (\n                            <Ui.Modal.Content>\n                                <Ui.Form.Loader/>\n                                <Ui.Modal.Header title={this.i18n(`Export translations`)} onClose={this.hide}/>\n                                <Ui.Modal.Body>\n                                    <Ui.Form.Error/>\n                                    <Ui.Grid.Row>\n                                        <Ui.Grid.Col all={12}>\n                                            <Ui.CheckboxGroup\n                                                validate=\"required\"\n                                                name=\"apps\"\n                                                label={this.i18n('Select apps to export')}\n                                                api=\"/services/webiny/apps\"\n                                                url=\"/installed\"\n                                                textAttr=\"name\"\n                                                valueAttr=\"name\"/>\n                                        </Ui.Grid.Col>\n                                    </Ui.Grid.Row>\n                                    {!_.isEmpty(availableGroups) && (\n                                        <Ui.Grid.Row>\n                                            <Ui.Grid.Col all={12}>\n                                                <Ui.CheckboxGroup\n                                                    tooltip={this.i18n('Only groups from selected apps are shown.')}\n                                                    validate=\"required\"\n                                                    name=\"groups\"\n                                                    textAttr=\"name\"\n                                                    options={availableGroups}\n                                                    label={this.i18n('Select groups to export')}/>\n                                            </Ui.Grid.Col>\n                                        </Ui.Grid.Row>\n                                    )}\n                                    <Ui.Grid.Row>\n                                        <Ui.Grid.Col all={12}>\n                                            <Ui.CheckboxGroup\n                                                validate=\"required\"\n                                                sort=\"key\"\n                                                name=\"locales\"\n                                                fields=\"id,label,key\"\n                                                textAttr=\"label\"\n                                                valueAttr=\"key\"\n                                                label={this.i18n('Select locales to export')}\n                                                api=\"/entities/webiny/i18n-locales\"/>\n                                        </Ui.Grid.Col>\n                                    </Ui.Grid.Row>\n                                    <Ui.Grid.Row>\n                                        <Ui.Grid.Col all={12}>\n                                            <Ui.RadioGroup name=\"fileType\" label={this.i18n('Select export file type')}>\n                                                <option value=\"json\">{this.i18n('JSON')}</option>\n                                                <option value=\"yaml\">{this.i18n('YAML')}</option>\n                                            </Ui.RadioGroup>\n                                        </Ui.Grid.Col>\n                                    </Ui.Grid.Row>\n                                </Ui.Modal.Body>\n                                <Ui.Modal.Footer >\n                                    <Ui.Button label={this.i18n(`Cancel`)} onClick={this.hide}/>\n                                    <Ui.DownloadLink\n                                        separate\n                                        disabled={_.isEmpty(model.apps) || _.isEmpty(model.groups) || _.isEmpty(model.locales)}\n                                        onClick={() => this.hide()}\n                                        method=\"POST\"\n                                        params={model}\n                                        type=\"primary\"\n                                        download={downloadUrl}>\n                                        {this.i18n(`Export`)}\n                                    </Ui.DownloadLink>\n                                </Ui.Modal.Footer>\n                            </Ui.Modal.Content>\n                        );\n                    }}\n                </Ui.Form>\n            </Ui.Modal.Dialog>\n        );\n    }\n}\n\nExportTranslationsModal.defaultProps = _.assign({}, Webiny.Ui.ModalComponent.defaultProps);\n\nexport default Webiny.createComponent(ExportTranslationsModal, {\n    modulesProp: 'Ui',\n    modules: [\n        'Modal', 'Form', 'Grid', 'CheckboxGroup', 'Checkbox', 'Button', 'DownloadLink', 'RadioGroup'\n    ]\n});"]}