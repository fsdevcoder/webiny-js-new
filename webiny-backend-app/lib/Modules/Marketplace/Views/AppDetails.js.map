{"version":3,"sources":["../../../../src/Modules/Marketplace/Views/AppDetails.jsx"],"names":["AppDetails","props","bindMethods","setState","loading","id","Router","getParams","Api","Endpoint","get","then","app","apiResponse","getData","state","Button","updateAvailable","webinyVersionOk","installedVersion","updateModal","show","i18n","installModal","Ui","View","defaultProps","renderer","styles","Link","Grid","Tabs","Loader","Alert","appDetails","appWebinyVersion","webinyVersion","currentVersion","installedWebinyVersion","header","title","logo","src","titleBlock","name","shortDescription","action","renderCTA","ref","updateSuccessModal","images","map","a","longDescription","readme","changeLog","createComponent","modules"],"mappings":"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","file":"AppDetails.js","sourcesContent":["import React from 'react';\nimport {Webiny} from 'webiny-client';\nimport styles from './styles.css';\nimport './draft.scss';\nimport InstallModal from '../Components/InstallModal';\nimport UpdateModal from '../Components/UpdateModal';\nimport UpdateSuccessModal from '../Components/UpdateSuccessModal';\nimport Sidebar from '../Components/AppDetails/Sidebar';\nimport Carousel from '../Components/AppDetails/Carousel';\nimport ContentBlock from '../Components/AppDetails/ContentBlock';\n\n/**\n * @i18n.namespace Webiny.Backend.Marketplace.AppDetails\n */\nclass AppDetails extends Webiny.Ui.View {\n    constructor(props) {\n        super(props);\n\n        this.bindMethods('renderCTA');\n    }\n\n    componentWillMount() {\n        super.componentWillMount();\n        this.setState({loading: true});\n        const id = Webiny.Router.getParams('id');\n        new Webiny.Api.Endpoint('/services/webiny/marketplace').get(`apps/${id}`).then(apiResponse => {\n            this.setState({loading: false, app: apiResponse.getData('entity')});\n        });\n    }\n\n    renderCTA() {\n        const {app} = this.state;\n        const {Button} = this.props;\n\n        if (!app.updateAvailable || !app.webinyVersionOk) {\n            return null;\n        }\n\n        if (app.installedVersion) {\n            return (\n                <Button type=\"primary\" icon=\"fa-download\" label={`Update`} onClick={() => this.updateModal.show()}/>\n            );\n        }\n\n        return (\n            <Button type=\"secondary\" icon=\"fa-download\" label={this.i18n('Install')} onClick={() => this.installModal.show()}/>\n        );\n    }\n}\n\nAppDetails.defaultProps = {\n    renderer() {\n        const {loading, app} = this.state;\n        const {styles, Link, View, Grid, Button, Tabs, Loader, Alert} = this.props;\n\n        if (loading) {\n            return <Loader>{this.i18n('Fetching app details...')}</Loader>;\n        }\n\n        return (\n            <div className={styles.appDetails}>\n                {!app.webinyVersionOk && (\n                    <Alert type=\"warning\">\n                        {this.i18n(`This app requires Webiny {appWebinyVersion}. Your current Webiny is {currentVersion}.`, {\n                            appWebinyVersion: <strong>{app.webinyVersion}</strong>,\n                            currentVersion: <strong>{app.installedWebinyVersion}</strong>\n                        })}\n                        <br/>\n                        {this.i18n('Please update Webiny before attempting to install this app.')}\n                    </Alert>\n                )}\n                <div className={styles.header}>\n                    <div className={styles.title}>\n                        <img src={app.logo.src} className={styles.logo}/>\n                        <div className={styles.titleBlock}>\n                            <h2>{app.name}</h2>\n                            <p>{app.shortDescription}</p>\n                        </div>\n                    </div>\n                    <div className={styles.action}>\n                        {this.renderCTA()}\n                        <InstallModal ref={ref => this.installModal = ref} app={app}/>\n                        <UpdateModal ref={ref => this.updateModal = ref} app={app} onUpdated={() => this.updateSuccessModal.show()}/>\n                        <UpdateSuccessModal ref={ref => this.updateSuccessModal = ref} app={app}/>\n                        {/*<span onClick={() => this.updateSuccessModal.show()}>ShowSuccess</span>*/}\n                    </div>\n                </div>\n                <Tabs>\n                    <Tabs.Tab label={this.i18n('Details')} icon=\"fa-home\">\n                        <Grid.Row>\n                            <Grid.Col all={8}>\n                                <Carousel images={app.images.map(a => a.src)}/>\n                                <ContentBlock title={this.i18n('About')} content={app.longDescription}/>\n                            </Grid.Col>\n                            <Grid.Col all={4}>\n                                <Sidebar app={app}/>\n                            </Grid.Col>\n                        </Grid.Row>\n                    </Tabs.Tab>\n                    <Tabs.Tab label={this.i18n('Installation')} icon=\"fa-hdd-o\">\n                        <Grid.Row>\n                            <Grid.Col all={8}>\n                                <ContentBlock title={this.i18n('Installation')} content={app.readme}/>\n                            </Grid.Col>\n                            <Grid.Col all={4}>\n                                <Sidebar app={app}/>\n                            </Grid.Col>\n                        </Grid.Row>\n                    </Tabs.Tab>\n                    <Tabs.Tab label={this.i18n('Change Log')} icon=\"fa-pencil\">\n                        <Grid.Row>\n                            <Grid.Col all={8}>\n                                <ContentBlock title={this.i18n('Change log')} content={app.changeLog}/>\n                            </Grid.Col>\n                            <Grid.Col all={4}>\n                                <Sidebar app={app}/>\n                            </Grid.Col>\n                        </Grid.Row>\n                    </Tabs.Tab>\n                </Tabs>\n            </div>\n        );\n    }\n};\n\nexport default Webiny.createComponent(AppDetails, {\n    styles,\n    modules: ['View', 'Link', 'Gravatar', 'Grid', 'Button', 'Tabs', 'Loader', 'Alert']\n});"]}