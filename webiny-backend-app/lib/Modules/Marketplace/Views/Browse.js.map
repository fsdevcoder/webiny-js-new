{"version":3,"sources":["../../../../src/Modules/Marketplace/Views/Browse.jsx"],"names":["Browse","props","state","apps","user","loadingUser","bindMethods","setState","meEp","Api","Endpoint","get","then","apiResponse","isError","onUser","getData","cancel","appsEp","loadingApps","authToken","loadApps","Loader","i18n","styles","Link","View","Icon","Grid","browse","appDetails","appList","map","app","id","Ui","defaultProps","renderer","renderBody","createComponent","modules"],"mappings":"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","file":"Browse.js","sourcesContent":["import React from 'react';\nimport {Webiny} from 'webiny-client';\nimport styles from './styles.css';\nimport AppBox from './../Components/AppBox';\nimport SubmitAppBox from './../Components/SubmitAppBox';\nimport LoginRegister from './LoginRegister';\nimport User from './../Components/User';\n\n/**\n * @i18n.namespace Webiny.Backend.Marketplace.Browse\n */\nclass Browse extends Webiny.Ui.View {\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            apps: [],\n            user: null,\n            loadingUser: false\n        };\n\n        this.bindMethods('onUser');\n    }\n\n    componentWillMount() {\n        super.componentWillMount();\n        this.setState({loadingUser: true});\n        this.meEp = new Webiny.Api.Endpoint('/services/webiny/marketplace').get('/me').then(apiResponse => {\n            if (!apiResponse.isError()) {\n                this.onUser(apiResponse.getData());\n            }\n            this.setState({loadingUser: false});\n        });\n    }\n\n    componentWillUnmount() {\n        super.componentWillUnmount();\n        this.meEp && this.meEp.cancel();\n        this.appsEp && this.appsEp.cancel();\n    }\n\n    loadApps() {\n        this.setState({loadingApps: true});\n        this.appsEp = new Webiny.Api.Endpoint('/services/webiny/marketplace').get('/apps').then(apiResponse => {\n            this.setState({apps: apiResponse.getData('list'), loadingApps: false});\n        });\n    }\n\n    onUser({authToken, user}) {\n        this.setState({authToken, user});\n        if (user) {\n            this.loadApps();\n        }\n    }\n\n    renderBody() {\n        const {Loader} = this.props;\n        if (this.state.loadingUser) {\n            return <Loader>{this.i18n('Logging in...')}</Loader>;\n        }\n\n        if (this.state.loadingApps) {\n            return <Loader>{this.i18n('Fetching Webiny apps...')}</Loader>;\n        }\n\n        if (!this.state.user) {\n            return (\n                <LoginRegister onUser={this.onUser}/>\n            );\n        }\n\n        const {styles, Link, View, Icon, Grid} = this.props;\n\n        return (\n            <div className={styles.browse}>\n                <View.Dashboard>\n                    <View.Header title={this.i18n('Marketplace')}>\n                        <View.Header.Center>\n                            <User user={this.state.user}/>\n                        </View.Header.Center>\n                        {this.props.appDetails ?\n                            <Link type=\"default\" route=\"Marketplace.Browse\">{this.i18n('Go Back')}</Link> :\n                            <Link\n                                newTab\n                                type=\"default\"\n                                url={`https://www.webiny.com/token/${this.state.authToken}`}>\n                                <Icon icon=\"fa-cog\"/> {this.i18n('Manage Account')}\n                            </Link>\n                        }\n                    </View.Header>\n                    <View.Body>\n                        <Webiny.Ui.Placeholder name=\"Apps\">\n                            <Grid.Row className={styles.appList}>\n                                {this.state.apps && this.state.apps.map(app => (\n                                    <Grid.Col all={6} key={app.id}>\n                                        <AppBox app={app}/>\n                                    </Grid.Col>\n                                ))}\n                                <Grid.Col all={6}>\n                                    <SubmitAppBox/>\n                                </Grid.Col>\n                            </Grid.Row>\n                        </Webiny.Ui.Placeholder>\n                    </View.Body>\n                </View.Dashboard>\n            </div>\n        );\n    }\n}\n\nBrowse.defaultProps = {\n    renderer() {\n        return this.renderBody();\n    }\n};\n\nexport default Webiny.createComponent(Browse, {styles, modules: ['View', 'Link', 'Icon', 'Grid', 'Loader']});"]}